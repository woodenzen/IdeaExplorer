<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>

<head>
    <title>Custom HTML Prompt with Dynamic Size and Position</title>

    <style type="text/css">

    </style>

    <script type="text/javascript">
        // Gets the KM variable with the specified name. If the variable
        // is empty and "required" is true, an exception is thrown.
        // Otherwise, the variable's value is returned,
        function getKMVariable(name, required) {
            var value = window.KeyboardMaestro.GetVariable(name);
            if (required && !value) {
                throw Error("Variable '" + name + "' not set");
            }
            return value;
        }

        // Keyboard Maestro calls this function when the window is ready.
        function KMWindow() {
            try {
                // Set the body style to the desired width and height
                document.body.style.width = getKMVariable("dspBodyWidth", true) + 'px';
                document.body.style.height = getKMVariable("dspBodyHeight", true) + 'px';

                // Setup the position and size, and return it. KM will
                // use the values to set the position and size of the
                // window. If no position has been set yet, we default it.
                // KM will parse the variable names "dspWindowWidth" and
                // "dspWindowHeight" for us.
                var lastPosition = getKMVariable("dspWindowPosition");
                if (lastPosition == '') {
                    lastPosition = "200, 200";
                }

                return lastPosition + ", dspWindowWidth, dspWindowHeight";
            } catch (e) {
                document.write("Error in KMWindow(): " + e + "<br>");
            }
        }

        // Store our window position in a KM variable.
        function saveWindowPosition() {
            window.KeyboardMaestro.SetVariable('dspWindowPosition', window.screenX + ',' + window.screenY);
        }

        // Make sure we store our position before submitting the form.
        function submitWindow(result) {
            saveWindowPosition();
            window.KeyboardMaestro.Submit(result);
        }

        // Make sure we store our position before canceling the form.
        // NOTE: This does NOT get called when the user uses the Escape
        // key to exit the form.
        function cancelWindow(result) {
            saveWindowPosition();
            window.KeyboardMaestro.Cancel(result);
        }
    </script>
</head>
<body>
        <table border="1" class="dataframe">
            <thead>
                <tr style="text-align: right;">
                    <th></th>
                    <th>Title</th>
                    <th>Connection</th>
                    <th>Age</th>
                    <th>Last Modified</th>
                    <th>WC</th>
                    <th>LW</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <th>0</th>
                    <td>A Proustian View On How to Be a Good Friend</td>
                    <td>Bilateral</td>
                    <td>142 days</td>
                    <td>79 days ago</td>
                    <td>560</td>
                    <td>{10}</td>
                </tr>
                <tr>
                    <th>2</th>
                    <td>Solitude and Leadership</td>
                    <td>Bilateral</td>
                    <td>1 year and 237 days</td>
                    <td>136 days ago</td>
                    <td>400</td>
                    <td>{12}</td>
                </tr>
                <tr>
                    <th>10</th>
                    <td>S-Solitude</td>
                    <td>Bilateral</td>
                    <td>4 years and 55 days</td>
                    <td>73 days ago</td>
                    <td>262</td>
                    <td>{14}</td>
                </tr>
                <tr>
                    <th>1</th>
                    <td>What makes something interesting?</td>
                    <td>Inbound</td>
                    <td>326 days</td>
                    <td>143 days ago</td>
                    <td>152</td>
                    <td>{7}</td>
                </tr>
                <tr>
                    <th>3</th>
                    <td>H-Wandering</td>
                    <td>Inbound</td>
                    <td>1 year and 260 days</td>
                    <td>56 days ago</td>
                    <td>605</td>
                    <td>{31}</td>
                </tr>
                <tr>
                    <th>4</th>
                    <td>Switching Costs When Surfing Zettel</td>
                    <td>Outbound</td>
                    <td>1 year and 317 days</td>
                    <td>265 days ago</td>
                    <td>196</td>
                    <td>{11}</td>
                </tr>
                <tr>
                    <th>5</th>
                    <td>A-The Evolutionary Benefit of Friendship</td>
                    <td>Outbound</td>
                    <td>2 years and 195 days</td>
                    <td>194 days ago</td>
                    <td>518</td>
                    <td>{14}</td>
                </tr>
                <tr>
                    <th>6</th>
                    <td>Processing Of Thoughts While Speaking and Writing</td>
                    <td>Outbound</td>
                    <td>2 years and 266 days</td>
                    <td>115 days ago</td>
                    <td>487</td>
                    <td>{23}</td>
                </tr>
                <tr>
                    <th>7</th>
                    <td>A-Processing Of Thoughts While Speaking</td>
                    <td>Outbound</td>
                    <td>2 years and 274 days</td>
                    <td>73 days ago</td>
                    <td>641</td>
                    <td>{16}</td>
                </tr>
                <tr>
                    <th>8</th>
                    <td>A-Processing Of Thoughts While Talking</td>
                    <td>Outbound</td>
                    <td>2 years and 274 days</td>
                    <td>273 days ago</td>
                    <td>444</td>
                    <td>{9}</td>
                </tr>
                <tr>
                    <th>9</th>
                    <td>Creative Work Needs Solitude</td>
                    <td>Outbound</td>
                    <td>2 years and 298 days</td>
                    <td>297 days ago</td>
                    <td>270</td>
                    <td>{11}</td>
                </tr>
            </tbody>
        </table>
    <div style="text-align: center">Custom HTML Prompt with Dynamic Size and Position</div>
    <div id="divButtons" style="text-align:center; margin-top: 10px;">
        <input type="button" value="Cancel" onclick="cancelWindow('Cancel')">
        <input type="button" value="OK" onclick="submitWindow('OK')">
    </div>

</body>

</html>